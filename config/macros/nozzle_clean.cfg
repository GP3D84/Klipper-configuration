[gcode_macro NOZZLE_CLEAN]
description: wipes nozzle on brush to clean it
gcode:
  {% if (printer.toolhead.position.z|float) <=1 %}
    {% if printer['gcode_macro LED_cleaning'] is defined %}
      LED_cleaning
    {% endif %}
  {% set coord_z = (printer.toolhead.position.z|float) %}
  M118 NOZZLE_CLEAN
  M117 NOZZLE_CLEAN
    {% set x_max = printer.toolhead.axis_maximum.x %}
    {% set y_max = printer.toolhead.axis_maximum.y %}
  G90
  Z_SAFE
  G1 X{x_max} F6000
  G1 Y{y_max} F6000
  G1 X265 Y{y_max} F6000
  
  G1 Z10 F3000
  G1 X315 F10000
  G1 X265 F10000
  G1 X315 F10000
  G1 X265 F10000
  G1 X315 F10000
  G1 X265 F10000
  
  G1 Z{coord_z}
  
  {% else %}
      M118 Can't clean: toolhead.position.z >1
      M117 Can't clean!
  {% endif %}

[gcode_macro NOZZLE_PRIME]
description: prime the nozzle before printing
gcode:
    {% if printer['gcode_macro LED_cleaning'] is defined %}
      LED_cleaning
    {% endif %}
  M118 NOZZLE_PRIME
  M117 NOZZLE_PRIME
  G92 E0
  G1 E-3 F1800
  G1 X0 Y0 F10000
  G1 Z0.3 F500
  G92 E0
  G1 E3 F500
  G92 E0
  G1 E-0.30000 F3600
  G1 Z0.2500 F1000
  G1 X350 Y0 E50 F1000 
  G92 E0
  G1 E-0.30000 F5400
  G1 Z10 F500
